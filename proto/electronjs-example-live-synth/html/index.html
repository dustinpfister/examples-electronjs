<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title> Live Synth </title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>

    <div class="wrap_main" >
        <h1>Hello World</h1>
<script type="module">

// started working with this:
// https://stackoverflow.com/questions/67342004/how-to-continuously-generate-raw-audio-samples-in-javascript-using-the-web-audio
const blob = new Blob(
    [`
        class MyProcessor extends AudioWorkletProcessor {

            constructor(){
                super();
                this.amp = 1;
                this.count = 0;
                this.st = new Date();
            }

            process(inputList, outputs, parameters) {
                for (const output of outputs) {
                    for (const channelData of output) {
                        const len = channelData.length;
                        for (let i = 0; i < len; i += 1) {
                            const a = i / len;


                            const amp = this.amp;

                            channelData[i] = Math.sin(Math.PI * 2 * a) * amp - amp / 2;
                        }
                    }
                }
                this.count += 1;

                if(this.count % 256 === 0){



                }

                return true;
            }
        }
        registerProcessor('my-processor', MyProcessor);
    `],
    { type: 'application/javascript' }
);
const url = URL.createObjectURL(blob);

const audioContext = new AudioContext();

await audioContext.audioWorklet.addModule(url);

//audioContext.audioWorklet.addModule(url);

const myAudioWorkletNode = new AudioWorkletNode(audioContext, 'my-processor');

myAudioWorkletNode.connect(audioContext.destination);


//console.log(audioContext);
//console.log(myAudioWorkletNode);



</script>


    </div>

  </body>
</html>